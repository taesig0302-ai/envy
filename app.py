# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ENVY Research Tool v11.x ì•ˆì •íŒ íŒ¨ì¹˜ â€” íŒŒíŠ¸ë³„ ì½”ë“œ ë²ˆë“¤
# Streamlit ê¸°ë°˜ ëª¨ë†€ë¦¬ì‹ â†’ ëª¨ë“ˆ ë¶„ë¦¬ êµ¬ì¡° (ì‚¬ì´ë“œë°” / ë°ì´í„°ë© / 11ë²ˆê°€ / ë¼ì¿ í… / ë²ˆì—­ê¸° / ê¸°íƒ€)
# ë³¸ íŒŒì¼ì€ ê° íŒŒíŠ¸ë¥¼ í•œ ë¬¸ì„œì— ëª¨ì•„ë‘” â€˜ì‘ì—…ìš© ë²ˆë“¤â€™ì…ë‹ˆë‹¤.
# ì‹¤ì œ ì‚¬ìš© ì‹œì—ëŠ” ì•„ë˜ ì„¹ì…˜ë³„ ì½”ë“œë¥¼ ê°œë³„ íŒŒì¼ë¡œ ë¶„ë¦¬í•˜ì„¸ìš”.
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€


# ============================
# app.py (ë©”ì¸ ì—”íŠ¸ë¦¬)
# ============================
app_py = r"""
import streamlit as st
from datetime import datetime


st.set_page_config(page_title="ENvY Research Tool v11", layout="wide", initial_sidebar_state="expanded")


# íŒŒíŠ¸ ëª¨ë“ˆ ì„í¬íŠ¸ (ë™ì¼ í´ë” ê¸°ì¤€)
from sidebar import render_sidebar, get_headers
from datalab import render_datalab
from elevenst import render_elevenst
from rakuten_radar import render_rakuten_radar
from translator import render_translator
from misc import render_misc


# â”€â”€ ê¸€ë¡œë²Œ ìƒíƒœ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
if "envy_state" not in st.session_state:
st.session_state["envy_state"] = {"ts": datetime.now().isoformat()}


# â”€â”€ ì‚¬ì´ë“œë°” â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
cfg = render_sidebar()
headers = get_headers(cfg)


# â”€â”€ UI ì„¹ì…˜ ì¹´ë“œ ê°„ê²© & ì˜¤í”„ì…‹ ìœ í‹¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
def section_card(title: str, anchor: str = None):
st.markdown("""
<style>
.section-card{border-radius:16px;padding:22px 22px 18px;background:#0f1116;border:1px solid #222}
.section-title{font-weight:700;font-size:1.1rem;margin:0 0 14px}
</style>
""", unsafe_allow_html=True)
st.markdown(f"<div class='section-card' id='{anchor or title}'><div class='section-title'>ğŸ§­ {title}</div>", unsafe_allow_html=True)




def end_section():
st.markdown("</div>", unsafe_allow_html=True)
st.markdown("\n")


# â”€â”€ ì„¹ì…˜: ë„¤ì´ë²„ ë°ì´í„°ë© â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
section_card("ë„¤ì´ë²„ ë°ì´í„°ë© (í‚¤ì›Œë“œ + ê·¸ë˜í”„)", anchor="datalab")
render_datalab(cfg, headers)
end_section()


# ì„¹ì…˜ ìœ„ì¹˜ ë¯¸ì„¸ì¡°ì • (ìš”ì²­: ì›í•˜ëŠ” ìœ„ì¹˜ ëŒ€ë¹„ Â±5%) â†’ ë ˆì´ì•„ì›ƒ ì—¬ë°±ìœ¼ë¡œ ë³´ì •
st.markdown("<div style='height:12px'></div>", unsafe_allow_html=True)


# â”€â”€ ì„¹ì…˜: 11ë²ˆê°€ ë² ìŠ¤íŠ¸ì…€ëŸ¬ (í”„ë¡ì‹œ ë°°ë„ˆ ì œê±°) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
section_card("11ë²ˆê°€ ë² ìŠ¤íŠ¸ì…€ëŸ¬ (ëª¨ë°”ì¼, Cloudflare í”„ë¡ì‹œ)", anchor="11st")
render_elevenst(cfg)
end_section()


# â”€â”€ ì„¹ì…˜: AI í‚¤ì›Œë“œ ë ˆì´ë” (Rakuten) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
section_card("AI í‚¤ì›Œë“œ ë ˆì´ë” (Rakuten)", anchor="rakuten")
render_rakuten_radar(cfg, headers)
end_section()


# â”€â”€ ì„¹ì…˜: êµ¬ê¸€ ë²ˆì—­ê¸° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
section_card("êµ¬ê¸€ ë²ˆì—­ê¸° (ë¼ì¸ ë³‘ë ¬ ì¶œë ¥)", anchor="translator")
render_translator(cfg)
end_section()


# â”€â”€ ì„¹ì…˜: ê¸°íƒ€ (ìƒí’ˆëª… ìƒì„±ê¸° / API Key ë³´ê´€ ë“±) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
section_card("ê¸°íƒ€ ê¸°ëŠ¥", anchor="misc")
render_misc(cfg)
end_section()
"""


# ============================
# sidebar.py (ì‚¬ì´ë“œë°”)
# ============================
sidebar_py = r"""
import streamlit as st
from typing import Dict


# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# UI: í•œêµ­ì–´ í†µí™”í‘œê¸° ë¼ë²¨
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
CURRENCY_LABELS = {
"USD": "ë¯¸êµ­ ë‹¬ëŸ¬ (USD) $",
"KRW": "í•œêµ­ ì› (KRW) â‚©",
"JPY": "ì¼ë³¸ ì—” (JPY) Â¥",
"EUR": "ìœ ë¡œ (EUR) â‚¬",
"TWD": "ëŒ€ë§Œ ë‹¬ëŸ¬ (TWD) NT$",
"THB": "íƒœêµ­ ë°”íŠ¸ (THB) à¸¿",
"SGD": "ì‹±ê°€í¬ë¥´ ë‹¬ëŸ¬ (SGD) S$",
}


# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ë‹¤í¬ ëª¨ë“œ í† ê¸€ (CSS ì£¼ì… ë°©ì‹)
# Streamlit ëŸ°íƒ€ì„ì—ì„œ í…Œë§ˆ ì „í™˜ì´ ì •ì‹ ì§€ì›ë˜ì§€ ì•Šì•„, CSS ë³€ìˆ˜ë¡œ ê°„ì´ êµ¬í˜„
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
_DARK_CSS = """
<style>
:root{--card-bg:#0f1116;--card-border:#222;--txt:#e8eaed;--muted:#a3a3a3}
body, .stApp{background: #0b0e14 !important; color: var(--txt) !important}
.block-container{padding-top:1.2rem}
.sidebar-logo{display:flex;align-items:center;gap:.5rem;margin-bottom:.5rem}
.sidebar-card{border:1px solid var(--card-border);background:var(--card-bg);border-radius:14px;padding:12px;margin-bottom:10px}
.sidebar-metric{border-radius:12px;padding:10px 12px;margin-top:10px}
.fx{background:rgba(46,204,113,.12);border:1px solid rgba(46,204,113,.35)}